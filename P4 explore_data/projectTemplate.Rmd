Redwine quality Analysis by Gangadhara Naga Sai
========================================================

```{r warning=FALSE, message=FALSE, echo=FALSE, results='hide', packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.
# install.packages('MASS')
# install.packages('memisc')
# install.packages('COUNT')
# install.packages('corrplot')
# install.packages('sandwich')
# install.packages('msme')
# install.packages('GGally')
# install.packages('dplyr')
#install.packages('RGraphics')
library(RGraphics)
library(corrplot)
library(gridExtra)
library(RColorBrewer)
library(lattice)
library(MASS)
library(memisc)
library(COUNT)
library(msme)
library(sandwich)
library(GGally)
library(dplyr)
library(GlobalOptions)
#install.packages('GlobalOptions')
library(graphics)
library(ggplot2)
# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)

```

```{r , Load_the_Data  and data summary}
# Load the Data
# download.file("https://s3.amazonaws.com/udacity-hosted-downloads/ud651/wineQualityReds.csv","wineQualityReds.csv",method="curl")
redwines<-read.csv('wineQualityReds.csv')
redwines$X<-NULL
names(redwines)

dim(redwines)

str(redwines)

summary(redwines)
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}


```

```{r,echo=FALSE,message=FALSE,warning=FALSE}
transparent_theme <- theme(
 axis.title.x = element_blank(),
 axis.title.y = element_blank(),
 axis.text.x = element_blank(),
 axis.text.y = element_blank(),
 axis.ticks = element_blank(),
 panel.grid = element_blank(),
 axis.line = element_blank(),
 panel.background = element_rect(fill = "transparent",colour = NA),
 plot.background = element_rect(fill = "transparent",colour = NA))

Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
HistoBox <- function(x,i,l, na.rm = TRUE, ...) {
  m<-names(x)
  
  
  #Histogram of the variable x
  p1 <- ggplot(x,aes(x[,i],y=..density..))+
    geom_histogram(colour="black",alpha=1,fill="#993366",bins=30)+
    geom_line(stat='density',color="black",linetype = 2)+
    theme( axis.title.x = element_blank())
  
  
  # Box plot of the x variable
  
  
p2 <- ggplot(redwines, aes(factor(1), x[,i]))+
  geom_jitter(alpha = 0.2,color='#993366')+
  geom_boxplot(alpha=0.1,color='black')+
  stat_summary(fun.y=mean,shape=1,col='red',fill='red',geom='point')+
  geom_hline(yintercept = (median(x[,i]) + sd(x[,i])*3.5),linetype = 4)+
  coord_flip()+
  labs(y =m[i])
  #+transparent_theme
  
  #text or comments
  
  text<-paste(l[i],"Where the Standard deviation is",round(sd(x[,i]),3),",beyond ",round(sd(x[,i]) * 3.5+median(x[,i]),3)," we will find outliers ","and the average from boxplot is ",round(mean(x[,i]),3),". Histogram highest value"," at ",m[i]," equal to ",Mode(x[,i]),".")
    
  p3 <- splitTextGrob(text)
    
  grid.arrange(p1,p2,p3)
}


```



```{r, }



# plots = lapply(seq_along(m), function(x) HistoBox(redwines[,x],comments))
# require(gridExtra)
# do.call(grid.arrange,  c(plots,ncol=1))

#lapply(seq_along(nm), function(i) HistoBox(redwines,i,comments))


```

```{r,message=FALSE,echo=FALSE,results='hide'}
comments <-list("Fixed acidity is slightly a skewed Normal distribution."
                ," Volatile acidity is similar to fixed acidity, also has a long tail distribution.It is having a bimodal distribution."
                ,"Citric acid has quite a long-tail distribution.But it is not a Normal Distribution.And there are no wine of 8% concentration as in data"
                ,"Outliers are many fot Residual sugar which  has a very long-tail distribution.Maximum values are in between 1.9 to 2.6."
                ,"Almost similar to residual sugar with a very long-tail distribution.Maximum of values are between 0.07 and 0.09"
                ,"Free sulfur dioxide has a positively skewed distribution. Maximum of the values are between 9.50 and 11.10."
                ,"Same as last one, lesser outliers and its interquartile range  seems not quite large. It also has a long-tail distribution. "
                ,"Apperar quite like a normal  distribution,most of the values falling between 0.995 and 1."
                ,"pH is also normal distribuition with most of the pH values falling between 3.1 and 3.5. Not much outliers are seen."
                ," For sulphites most of the values seems to be concentrated at 0.6. It is a long tailed distribution and quite similar to chlorides and residual sugar."
                ," Most wines have less than 11% alcohol. Alcohol has a long-tail distribution, with there only being a few outliers"
                ,"Similar to fixed acidity's distibution,since fixed acidity comprises the most.Total acidity values typically fall between 7 and 10 and there are very few outliers."
                ,"combined sulfur dioxide has a distribution similar to total sulfur dioxide."
                )
redwinesx<-redwines
redwinesx$total.acidity<-redwines$fixed.acidity+redwines$volatile.acidity
redwinesx$combined.sulphur.dioxide<-redwines$total.sulfur.dioxide-redwines$free.sulfur.dioxide
redwinesx<-redwinesx[,c(1:11,13,14,12)]
lapply(1:13, function(i) HistoBox(redwinesx,i,comments))
ggplot(aes(quality), data = redwines) +geom_bar(colour="black",alpha = 1,fill =  "#993366")

```
Quality ranges from 0 to 10,but in data minimum is 3 and maximum is 8, which means that most of the wines we will look at in the analysis are average wines.
```{r}
summary(redwines$quality)

```




# Univariate Analysis

### What is the structure of your dataset?
>Data set is regarding the wine quality and several chemical componets that it contains.there ae 1599 samples of wine with 10 variables(fixed acidity, volatile acidity, citric acid, residual sugar, chlorides, free sulfur dioxide, total sulfer dioxide, density, pH, sulphates, alcohol, quality) of type numeric and 1 rating factor quality of type int.  

### What is/are the main feature(s) of interest in your dataset?
>Quality is the main feature of insterest ,given by 3 wine experts according to their knowledge and experience.Quality ranges from 0 to 10 but our data has least quality of 3 and highest quality of 8. Lets find out what are the main deciding factors for high quality wine.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
>There can lot more features since in real world so many factors affect the quality of Red wine.
>>Type of grapes used
>>flavor (like combination of different ingredients)
>>Color
>>taste(sweet,sour,bitter,etc)
>>total cost from the ingredients to final production of wine(since cost matters since high quality wine with less cost really matters)

### Did you create any new variables from existing variables in the dataset?
>Yes , i made total.acidity and combined.sulphur.dioxide, which may show some unseen trends.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
>Volatile acidity is having a bimodal distribution and Citric acid has quite a long-tail distribution.But it is not a Normal Distribution.
>the data was already tidy so there was no requirement for any adjustment.



# Bivariate Plots Section
## By using correlation we can find out some important insights among variables

```{r echo=FALSE, Bivariate_Plots}
corrplot.mixed(redwines)
```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
