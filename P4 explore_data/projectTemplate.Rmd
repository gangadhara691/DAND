Redwine quality Analysis by Gangadhara Naga Sai
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.
# install.packages('MASS')
# install.packages('memisc')
# install.packages('COUNT')
# 
# install.packages('sandwich')
# install.packages('msme')
# install.packages('GGally')
# install.packages('dplyr')
#install.packages('RGraphics')
library(RGraphics)
library(gridExtra)
library(gridExtra)
library(RColorBrewer)
library(lattice)
library(MASS)
library(memisc)
library(COUNT)
library(msme)
library(sandwich)
library(GGally)
library(dplyr)
library(GlobalOptions)
#install.packages('GlobalOptions')
library(graphics)
library(ggplot2)
# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.


```

```{r echo=FALSE, Load_the_Data,summarize data}
# Load the Data

redwines<-read.csv('wineQualityReds.csv')
redwines$X<-NULL
class(redwines)
names(redwines)
dim(redwines)
str(redwines)
summary(redwines)
```

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}


```

```{r fuctions}
transparent_theme <- theme(
 axis.title.x = element_blank(),
 axis.title.y = element_blank(),
 axis.text.x = element_blank(),
 axis.text.y = element_blank(),
 axis.ticks = element_blank(),
 panel.grid = element_blank(),
 axis.line = element_blank(),
 panel.background = element_rect(fill = "transparent",colour = NA),
 plot.background = element_rect(fill = "transparent",colour = NA))
sd_and_outlier <- function(feature) {
  stdev = sd(feature)
  outlier = stdev * 3.5 +median(feature)}

HistoBox <- function(x,i,l, na.rm = TRUE, ...) {
  
  
  text<-paste("SD:",round(sd(x[,i]),3),"\n","Outliers are beyond:",round(sd(x[,i]) * 3.5+median(x[,i]),3),l[i])
  # xmin <- min(x[,i]); xmax <- max(x[,i])
  #   ymin<-min(table(cut(x[,i],seq(min(x[,i]),max(x[,i]),dist(range(x[,i]))/30))))
  #   ymax<-max(table(cut(x[,i],seq(min(x[,i]),max(x[,i]),dist(range(x[,i]))/30)))) 
  
  m<-names(x)
  bw <- diff(range(x[,i])) / (2 * IQR(x[,i]) / length(x[,i])^(1/3))
  
  p1 <- ggplot(x,aes(x[,i])) + geom_histogram(colour="black",alpha = 1,fill =  "#993366",bins=bw)+
    theme( axis.title.x = element_blank())
    
  #+annotate("text", x = xmax/2, y = ymax, label = a)# see previous sections for the scatterPlot
  # Box plot of the x variable
 
  p3 <- splitTextGrob(text)
  p2 <- ggplot(redwines, aes(factor(1), x[,i]))+geom_jitter(alpha = 0.2,color='#993366')+ geom_boxplot(alpha = 0.2, color ='black')+stat_summary(fun.y=mean,shape=1,col='red',fill='red',geom='point')+
    geom_hline(yintercept = (median(x[,i]) + sd(x[,i])*3.5),
                     alpha = 1/3, linetype = 3)+
    coord_flip()+ labs(y =m[i])
  #transparent_theme
  return (grid.arrange(p1,p2,p3,heights=c(2,2,2)))
    #grid.arrange(arrangeGrob(p1,p2,ncol=1),widths=c(4,1),p3,ncol=2))
    #grid.arrange(p1,p2,p3,layout_matrix=(cbind(c(1,2), c(3,3)))))
}

HistoBox(redwines,5,comments)

```



```{r}



m<-names(redwines)
plots = lapply(seq_along(m), function(x) HistoBox(redwines[,x],comments))
require(gridExtra)
do.call(grid.arrange,  c(plots,ncol=1))

lapply(seq_along(nm), function(i) HistoBox(redwines,i,comments))


```

```{r}
comments <-list("Fixed acidity has a long-tail distribution, with a few outliers having a value greater than 14. The log10 plot does not reveal any new findings, although is does normalize the distribution.","Similar to fixed acidity, volatile acidity also has a long tail distribution. However, when we look at its log10 plots, we can see that the distribution looks a little binominal."
,"Given that citric acid has quite a long-tail distribution, I thought it would be worthwhile to scale the x-axis by log10. Looking at this new distribution it is interesting to that the distribution has switched from a long-right-tail to a long-left-tail distribution. It will be interesting to compare the original with the log10 transformation in the bivariate analysis."
,"Residual sugar has a very long-tail distribution with many outliers. Some of these outliers are more than 9 standard deviations away from the median! It will be interesting to see how these outliers affect the quality of wine. In the second plot, the top five percent of data points were removed to have a better understanding of core of the data. In the log10 plots, the values are still very skewed, but it looks more like a normal distribution."
,"Very similar to residual sugar, chlorides have a strong concentration of points around the median, as well as many outliers. The more extreme outliers are as much as 11 standard deviations away from the mean. In the second plot, the top two percent of data points were removed to help understand the distribution of points around the median. In the log10 plots, we can see that the data still has a long-tail skew, but looks more normally distributed. It is interesting to see the two outliers at the bottom of the box plot as a result of the transformation."
,"Free sulfur dioxide has a rather dispersed distribution as its interquartile range is rather large, relative to the previous features we have looked at. When taking a look at its log10 plot, it appears to be binomial, and the number of outliers has been greatly reduced."
,"Total sulfur dioxide is similar in ways to free sulfur dioxide. I would argue that its points are not quite a dispersed, as there are fewer outliers and its interquartile range does not look quite as large. It also has a long-tail distribution, but when we look at its log10 plot, the points are rather normally distributed"
,"Density has a very normal looking distribution with most of the values falling between 0.995 and 1. For comparison, water has a density of 1, so most of our wine is less dense than water. There are very few outliers."
,"Another normal looking distribution, with most of the pH values falling between 3.1 and 3.5. For more comparison, water is generally between 6.5 and 8.5, while vinegar is typically between 2.2 and 2.4. Much like with density, there are very few outliers."
,"Although sulphates is more long-tail than density and pH, it still looks rather normally distributed, as most of the values are clustered around 0.6. An interesting point about sulphates, is that some of its outliers are very far away from the outlier line, as much as 8.14 standard deviations away from the median! It will be interesting to see how that affects the quality of wine. Looking at its log10 plots, sulphates is much more normally distributed, and there are still some outliers, despite the transformation."
,"Alcohol has a long-tail distribution, with there only being a few outliers. Looking at the log10 plots does not reveal many new insights, except that it still has a long-tail distribution and looks oddly like the original plots. Most wines have less than 11% alcohol."
,"Quality is on a 1-10 scale, which means that most of the wines we will look at in the analysis are average wines. It will be interesting to try to find what can make a wine very good or very bad, and to see if there is much correlation between the variables."
)
comments[1]
# ,"Total acidity has a distribution very similar to fixed acidity, which makes sense because that is what makes up most of the total acidity. Values typically fall between 7 and 10, with there being few outliers. As expected, the log10 plots are also similar to fixed acidity, as the distribution is normalized, and there are very few outliers"
# ,"Bound sulfur dioxide has a distribution similar to total sulfur dioxide, as most of it is made of bound sulfur dioxide. Its values seem to be centered around 20, but there are a couple extreme outliers, 8.5 standard deviations away from the median. I wonder if these relate in any way to the extreme outliers from the sulphates data points. The log10 plots do not look as binomial when compared to the total sulfur dioxide plots. "
```

# Univariate Analysis

### What is the structure of your dataset?

### What is/are the main feature(s) of interest in your dataset?

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?

### Did you create any new variables from existing variables in the dataset?

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?



# Bivariate Plots Section
```{r echo=FALSE, Bivariate_Plots}

```

# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?

### What was the strongest relationship you found?




# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}

```

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?

### Were there any interesting or surprising interactions between features?

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}

```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}

```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}

```

### Description Three

------

# Reflection
